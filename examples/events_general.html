<!DOCTYPE html>
<html lang="en">

<head>
    <title>ag-three events</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="shortcut icon" href="files/favicon.ico" />
    <link type="text/css" rel="stylesheet" href="files/main.css">
</head>

<body>
    <div id="info">
        <a href="https://github.com/agargaro/three-interaction" target="_blank" rel="noopener">ag-three</a> - events
        <div>
            <span class="blink" id="pointerover">pointerover</span>
            <span class="blink" id="pointerout">pointerout</span>
            <span class="blink" id="pointermove">pointermove</span>
            <span class="blink" id="pointerdown">pointerdown</span>
            <span class="blink" id="pointerup">pointerup</span>
            <span class="blink" id="pointerintersection">pointerintersection</span>
            <span class="blink" id="click">click</span>
            <span class="blink" id="dblclick">dblclick</span>
            <span class="blink" id="wheel">wheel</span>
            <span class="blink" id="focus">focus</span>
            <span class="blink" id="blur">blur</span>
            <span class="blink" id="keydown">keydown</span>
            <span class="blink" id="keyup">keyup</span>
            <span class="blink" id="drag">drag</span>
            <span class="blink" id="dragstart">dragstart</span>
            <span class="blink" id="dragend">dragend</span>
            <span class="blink" id="drop">drop</span>
            <span class="blink" id="dragenter">dragenter</span>
            <span class="blink" id="dragleave">dragleave</span>
            <span class="blink" id="dragover">dragover</span>
            <span class="blink" id="dragcancel">dragcancel</span>
            <span class="blink" id="positionchange">positionchange</span>
            <span class="blink" id="scalechange">scalechange</span>
            <span class="blink" id="rotationchange">rotationchange</span>
            <span class="blink" id="rendererresize">rendererresize</span>
        </div>
    </div>
    <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three/build/three.module.min.js",
                "three/examples/": "https://unpkg.com/three/examples/"
            }
        }
    </script>

    <script type="module">

        import { BoxGeometry, DirectionalLight, Mesh, MeshLambertMaterial, Scene, SphereGeometry, PlaneGeometry } from "three";
        import { OrthographicCamera, Main } from "../src/index";

        const scene = new Scene().activeSmartRendering();
        scene.add(
            new OrthographicCamera(20).translateZ(10),
            new DirectionalLight(0xffffff, 0.7).translateZ(10),
            scene.box = new Mesh(new BoxGeometry(5, 5, 5), new MeshLambertMaterial({ color: 0xff6666 })).translateZ(-5),
            scene.sphere = new Mesh(new SphereGeometry(2), new MeshLambertMaterial({ color: 0x6666ff })).translateX(10),
            scene.plane = new Mesh(new PlaneGeometry(10, 15), new MeshLambertMaterial({ color: 0x66ff66 })).translateX(-10)
        );

        scene.sphere.draggable = true;

        scene.box.userData.className = "blink active-box";
        scene.sphere.userData.className = "blink active-sphere";
        scene.plane.userData.className = "blink active-plane";

        scene.bindEvent(["pointerover", "pointerout", "pointermove", "pointerdown", "pointerup", "pointerintersection", "click", "dblclick",
            "wheel", "focus", "blur", "keydown", "keyup", "drag", "dragstart", "dragend", "drop", "dragenter", "dragleave", "dragover", "dragcancel"],
            (event) => blink(document.getElementById(event.type), event.target.userData.className));

        scene.box.bindEvent("rotationchange", () => blink(document.getElementById("rotationchange"), scene.box.userData.className));
        scene.sphere.bindEvent("positionchange", () => blink(document.getElementById("positionchange"), scene.sphere.userData.className));
        scene.sphere.bindEvent("scalechange", () => blink(document.getElementById("scalechange"), scene.sphere.userData.className));
        scene.bindEvent("rendererresize", () => blink(document.getElementById("rendererresize"), scene.sphere.userData.className));

        scene.box.bindEvent("animate", function (e) {
            if (this.hovered) {
                this.rotation.y += e.delta;
                this.rotation.x += e.delta * 1.5;
            }
        });

        scene.bindEvent("focus", (e) => {
            e.target.material.emissive.set(0xcccc00);
            e.relatedTarget?.material.emissive.set(0);
        });

        scene.sphere.bindEvent("dragstart", function (e) {
            e.preventDefault(); // now will search for dropTarget
        });

        scene.plane.bindEvent(["dragenter", "dragleave", "drop", "dragcancel"], function (e) {
            this.material.emissive.set(e.type === "dragenter" ? 0xcccc00 : 0);
        });

        scene.sphere.bindEvent(["pointerover", "pointerout"], function (e) {
            this.scale.multiplyScalar(e.type === "pointerover" ? 1.2 : 1 / 1.2);
        });

        window.main = new Main({ scenes: [scene] }, { antialias: true });

        function blink(element, className) {
            clearTimeout(element.timer);
            element.className = className;
            element.timer = setTimeout(() => element.className = "blink", 200);
        }

        // missing : focusin, focusout, pointercancel, pointerenter, pointerleave

    </script>
</body>

</html>
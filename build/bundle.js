import*as t from"three";import*as e from"three/examples/jsm/lines/Line2";import*as s from"three/examples/jsm/lines/LineGeometry";import*as i from"three/examples/jsm/lines/LineMaterial";import*as n from"three/examples/jsm/libs/stats.module";var r={d:(t,e)=>{for(var s in e)r.o(e,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},a={};r.d(a,{x$:()=>d,H7:()=>L,wO:()=>u,Ex:()=>E,Qr:()=>G,kX:()=>F,SP:()=>l,td:()=>j,w_:()=>k,Ns:()=>D,or:()=>B,gb:()=>I,cP:()=>Y,DJ:()=>R,Ke:()=>X,RR:()=>U,MZ:()=>q,cQ:()=>_,CP:()=>W,tL:()=>T,Xp:()=>C,cu:()=>M,uF:()=>f,EU:()=>g,Lz:()=>V,zh:()=>z});const h=(o={Clock:()=>t.Clock,Color:()=>t.Color,EventDispatcher:()=>t.EventDispatcher,InstancedInterleavedBuffer:()=>t.InstancedInterleavedBuffer,InstancedMesh:()=>t.InstancedMesh,InterleavedBufferAttribute:()=>t.InterleavedBufferAttribute,MathUtils:()=>t.MathUtils,Matrix4:()=>t.Matrix4,Object3D:()=>t.Object3D,PerspectiveCamera:()=>t.PerspectiveCamera,Quaternion:()=>t.Quaternion,Raycaster:()=>t.Raycaster,ShaderMaterial:()=>t.ShaderMaterial,Vector2:()=>t.Vector2,Vector3:()=>t.Vector3,WebGLRenderTarget:()=>t.WebGLRenderTarget,WebGLRenderer:()=>t.WebGLRenderer},c={},r.d(c,o),c);var o,c;class l extends h.InstancedMesh{constructor(t,e,s,i,n){super(t,e,s),this.instances=[],this._tempMatrix=new h.Matrix4,this._tempColor=new h.Color,this._needsUpdate=!1,"number"==typeof n&&(n=this._tempColor.setHex(n));for(let t=0;t<s;t++)this.instances.push(new i(this,t,n));this.bindEvent("pointerintersection",(t=>{this.instances[t.intersection.instanceId].triggerEvent("pointerintersection",t)})),this.bindEvent("animate",(t=>{for(let e=0;e<this.count;e++)this.instances[e].triggerEvent("animate",t)}))}}class _{static areVector3Equals(t,e,s=this.eps){return!!(t&&e&&Math.abs(t.x-e.x)<=s&&Math.abs(t.y-e.y)<=s&&Math.abs(t.z-e.z)<=s)}static getSceneFromObj(t){for(;t;){if(t.isScene)return t;t=t.parent}}}_.eps=Math.pow(10,-8);class d{constructor(){this._set=new Set,this.data=[]}push(t){this._set.has(t.id)||(this._set.add(t.id),this.data.push(t))}has(t){return this._set.has(t.id)}clear(){this._set=new Set,this.data=[]}}class u{static push(t,e){if(this._allowedEventsSet.has(t)){let s=_.getSceneFromObj(e);if(s)this.pushScene(s,t,e);else{const i=()=>{s=_.getSceneFromObj(e),this.pushScene(s,t,e),e.removeEventListener("added",i)};e.addEventListener("added",i)}}}static pushScene(t,e,s){var i,n;const r=null!==(i=this._events[t.id])&&void 0!==i?i:this._events[t.id]={};(null!==(n=r[e])&&void 0!==n?n:r[e]=new d).push(s)}static remove(){}static dispatchEvent(t,e,s){const i=this._events[null==t?void 0:t.id];if(i&&i[e])for(const t of i[e].data)t.__eventsDispatcher.dispatchEvent(e,s)}}u._allowedEventsSet=new Set(["rendererresize","framerendering","animate"]),u._events={};const p=!1;h.Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!p,h.Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!p;const v=new d;function g(t){y(t.position),t.position._onChangeCallback=()=>{t.__eventsDispatcher.dispatchEvent("positionchange")},y(t.scale),t.scale._onChangeCallback=()=>{t.__eventsDispatcher.dispatchEvent("scalechange")}}function y(t){t._x=t.x,t._y=t.x,t._z=t.x,t.isVector3=!0,Object.setPrototypeOf(t,m.prototype),Object.defineProperties(t,{x:{get(){return this._x},set(t){this._x=t}},y:{get(){return this._y},set(t){this._y=t}},z:{get(){return this._z},set(t){this._z=t}}})}class m{set(t,e,s){return void 0===s&&(s=this._z),this._x=t,this._y=e,this._z=s,this._onChangeCallback(),this}setScalar(t){return this._x=t,this._y=t,this._z=t,this._onChangeCallback(),this}setX(t){return this._x=t,this._onChangeCallback(),this}setY(t){return this._y=t,this._onChangeCallback(),this}setZ(t){return this._z=t,this._onChangeCallback(),this}setComponent(t,e){switch(t){case 0:this._x=e;break;case 1:this._y=e;break;case 2:this._z=e;break;default:throw new Error("index is out of range: "+t)}return this._onChangeCallback(),this}getComponent(t){switch(t){case 0:return this._x;case 1:return this._y;case 2:return this._z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this._x,this._y,this._z)}copy(t,e){return this._x=t.x,this._y=t.y,this._z=t.z,!1!==e&&this._onChangeCallback(),this}add(t){return this._x+=t.x,this._y+=t.y,this._z+=t.z,this._onChangeCallback(),this}addScalar(t){return this._x+=t,this._y+=t,this._z+=t,this._onChangeCallback(),this}addVectors(t,e){return this._x=t.x+e.x,this._y=t.y+e.y,this._z=t.z+e.z,this._onChangeCallback(),this}addScaledVector(t,e){return this._x+=t.x*e,this._y+=t.y*e,this._z+=t.z*e,this._onChangeCallback(),this}sub(t){return this._x-=t.x,this._y-=t.y,this._z-=t.z,this._onChangeCallback(),this}subScalar(t){return this._x-=t,this._y-=t,this._z-=t,this._onChangeCallback(),this}subVectors(t,e){return this._x=t.x-e.x,this._y=t.y-e.y,this._z=t.z-e.z,this._onChangeCallback(),this}multiply(t){return this._x*=t.x,this._y*=t.y,this._z*=t.z,this._onChangeCallback(),this}multiplyScalar(t,e){return this._x*=t,this._y*=t,this._z*=t,!1!==e&&this._onChangeCallback(),this}multiplyVectors(t,e){return this._x=t.x*e.x,this._y=t.y*e.y,this._z=t.z*e.z,this._onChangeCallback(),this}applyEuler(t){return this.applyQuaternion(x.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(x.setFromAxisAngle(t,e))}applyMatrix3(t,e){const s=this._x,i=this._y,n=this._z,r=t.elements;return this._x=r[0]*s+r[3]*i+r[6]*n,this._y=r[1]*s+r[4]*i+r[7]*n,this._z=r[2]*s+r[5]*i+r[8]*n,!1!==e&&this._onChangeCallback(),this}applyNormalMatrix(t){return this.applyMatrix3(t,!1).normalize()}applyMatrix4(t,e){const s=this._x,i=this._y,n=this._z,r=t.elements,a=1/(r[3]*s+r[7]*i+r[11]*n+r[15]);return this._x=(r[0]*s+r[4]*i+r[8]*n+r[12])*a,this._y=(r[1]*s+r[5]*i+r[9]*n+r[13])*a,this._z=(r[2]*s+r[6]*i+r[10]*n+r[14])*a,!1!==e&&this._onChangeCallback(),this}applyQuaternion(t){const e=this._x,s=this._y,i=this._z,n=t.x,r=t.y,a=t.z,h=t.w,o=h*e+r*i-a*s,c=h*s+a*e-n*i,l=h*i+n*s-r*e,_=-n*e-r*s-a*i;return this._x=o*h+_*-n+c*-a-l*-r,this._y=c*h+_*-r+l*-n-o*-a,this._z=l*h+_*-a+o*-r-c*-n,this._onChangeCallback(),this}project(t){return this.applyMatrix4(t.matrixWorldInverse,!1).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse,!1).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this._x,s=this._y,i=this._z,n=t.elements;return this._x=n[0]*e+n[4]*s+n[8]*i,this._y=n[1]*e+n[5]*s+n[9]*i,this._z=n[2]*e+n[6]*s+n[10]*i,this.normalize()}divide(t){return this._x/=t.x,this._y/=t.y,this._z/=t.z,this._onChangeCallback(),this}divideScalar(t,e){return this.multiplyScalar(1/t,e)}min(t){return this._x=Math.min(this._x,t.x),this._y=Math.min(this._y,t.y),this._z=Math.min(this._z,t.z),this._onChangeCallback(),this}max(t){return this._x=Math.max(this._x,t.x),this._y=Math.max(this._y,t.y),this._z=Math.max(this._z,t.z),this._onChangeCallback(),this}clamp(t,e){return this._x=Math.max(t.x,Math.min(e.x,this._x)),this._y=Math.max(t.y,Math.min(e.y,this._y)),this._z=Math.max(t.z,Math.min(e.z,this._z)),this._onChangeCallback(),this}clampScalar(t,e){return this._x=Math.max(t,Math.min(e,this._x)),this._y=Math.max(t,Math.min(e,this._y)),this._z=Math.max(t,Math.min(e,this._z)),this._onChangeCallback(),this}clampLength(t,e){const s=this.length();return this.divideScalar(s||1,!1).multiplyScalar(Math.max(t,Math.min(e,s)))}floor(){return this._x=Math.floor(this._x),this._y=Math.floor(this._y),this._z=Math.floor(this._z),this._onChangeCallback(),this}ceil(){return this._x=Math.ceil(this._x),this._y=Math.ceil(this._y),this._z=Math.ceil(this._z),this._onChangeCallback(),this}round(){return this._x=Math.round(this._x),this._y=Math.round(this._y),this._z=Math.round(this._z),this._onChangeCallback(),this}roundToZero(){return this._x=this._x<0?Math.ceil(this._x):Math.floor(this._x),this._y=this._y<0?Math.ceil(this._y):Math.floor(this._y),this._z=this._z<0?Math.ceil(this._z):Math.floor(this._z),this._onChangeCallback(),this}negate(){return this._x=-this._x,this._y=-this._y,this._z=-this._z,this._onChangeCallback(),this}dot(t){return this._x*t.x+this._y*t.y+this._z*t.z}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)}manhattanLength(){return Math.abs(this._x)+Math.abs(this._y)+Math.abs(this._z)}normalize(t){return this.divideScalar(this.length()||1,t)}setLength(t){return this.normalize(!1).multiplyScalar(t)}lerp(t,e){return this._x+=(t.x-this._x)*e,this._y+=(t.y-this._y)*e,this._z+=(t.z-this._z)*e,this._onChangeCallback(),this}lerpVectors(t,e,s){return this._x=t.x+(e.x-t.x)*s,this._y=t.y+(e.y-t.y)*s,this._z=t.z+(e.z-t.z)*s,this._onChangeCallback(),this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const s=t.x,i=t.y,n=t.z,r=e.x,a=e.y,h=e.z;return this._x=i*h-n*a,this._y=n*r-s*h,this._z=s*a-i*r,this._onChangeCallback(),this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const s=t.dot(this)/e;return this.copy(t,!1).multiplyScalar(s)}projectOnPlane(t){return b.copy(this).projectOnVector(t),this.sub(b)}reflect(t){return this.sub(b.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const s=this.dot(t)/e;return Math.acos(h.MathUtils.clamp(s,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this._x-t.x,s=this._y-t.y,i=this._z-t.z;return e*e+s*s+i*i}manhattanDistanceTo(t){return Math.abs(this._x-t.x)+Math.abs(this._y-t.y)+Math.abs(this._z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,s){const i=Math.sin(e)*t;return this._x=i*Math.sin(s),this._y=Math.cos(e)*t,this._z=i*Math.cos(s),this._onChangeCallback(),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,s){return this._x=t*Math.sin(e),this._y=s,this._z=t*Math.cos(e),this._onChangeCallback(),this}setFromMatrixPosition(t){const e=t.elements;return this._x=e[12],this._y=e[13],this._z=e[14],this._onChangeCallback(),this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),s=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this._x=e,this._y=s,this._z=i,this._onChangeCallback(),this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._onChangeCallback(),this}setFromColor(t){return this._x=t.r,this._y=t.g,this._z=t.b,this._onChangeCallback(),this}equals(t){return t.x===this._x&&t.y===this._y&&t.z===this._z}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._onChangeCallback(),this}random(){return this._x=Math.random(),this._y=Math.random(),this._z=Math.random(),this._onChangeCallback(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,s=Math.sqrt(1-Math.pow(t,2));return this._x=s*Math.cos(e),this._y=s*Math.sin(e),this._z=t,this._onChangeCallback(),this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z}}const b=new h.Vector3,x=new h.Quaternion;function f(t){const e=t.quaternion._onChangeCallback;t.quaternion._onChange((()=>{e(),t.__eventsDispatcher.dispatchEvent("quaternionchange")}))}function C(t){const e=t.rotation._onChangeCallback;t.rotation._onChange((()=>{e(),t.__eventsDispatcher.dispatchEvent("rotationchange")}))}const z={};function M(t){t.__patched||(g(t),f(t),C(t),t.matrix.compose=function(t,e,s){const i=this.elements,n=e._x,r=e._y,a=e._z,h=e._w,o=n+n,c=r+r,l=a+a,_=n*o,d=n*c,u=n*l,p=r*c,v=r*l,g=a*l,y=h*o,m=h*c,b=h*l,x=s._x,f=s._y,C=s._z;return i[0]=(1-(p+g))*x,i[1]=(d+b)*x,i[2]=(u-m)*x,i[3]=0,i[4]=(d-b)*f,i[5]=(1-(_+g))*f,i[6]=(v+y)*f,i[7]=0,i[8]=(u+m)*C,i[9]=(v-y)*C,i[10]=(1-(_+p))*C,i[11]=0,i[12]=t._x,i[13]=t._y,i[14]=t._z,i[15]=1,this},t.__patched=!0)}h.Object3D.prototype.activable=!1,h.Object3D.prototype.active=!1,h.Object3D.prototype.hovered=!1,h.Object3D.prototype.enabled=!0,h.Object3D.prototype.interceptByRaycaster=!0,Object.defineProperty(h.Object3D.prototype,"activableObj",{get:function(){let t=this;for(;t&&!t.activable;)t=t.parent;return t}}),h.Object3D.prototype.bindEvent=function(t,e){if("string"==typeof t)return this.__eventsDispatcher.addEventListener(t,e);for(const s of t)this.__eventsDispatcher.addEventListener(s,e);return e},h.Object3D.prototype.hasBoundEvent=function(t,e){return this.__eventsDispatcher.hasEventListener(t,e)},h.Object3D.prototype.unbindEvent=function(t,e){this.__eventsDispatcher.removeEventListener(t,e)},h.Object3D.prototype.triggerEvent=function(t,e){this.__eventsDispatcher.dispatchDOMEvent(t,e)},h.Object3D.prototype.triggerEventAncestor=function(t,e){this.__eventsDispatcher.dispatchDOMEventAncestor(t,e)},Object.defineProperty(h.Object3D.prototype,"userData",{set:function(t){var e;this._patched||(z[this.id]=this,this.__eventsDispatcher=new E(this),e=this,p&&e.bindEvent(["positionchange","scalechange","quaternionchange","rotationchange"],(()=>{v.push(e)})),this._patched=!0),Object.defineProperty(this,"userData",{value:t,writable:!0})}});class E{constructor(t){this.parent=t,this._listeners={}}addEventListener(t,e){return this._listeners[t]||(this._listeners[t]=[],this.parent.isObject3D&&(u.push(t,this.parent),"positionchange"!==t&&"scalechange"!==t&&"rotationchange"!==t&&"quaternionchange"!==t||M(this.parent))),-1===this._listeners[t].indexOf(e)&&this._listeners[t].push(e),e}hasEventListener(t,e){var s,i;return!(null===(i=null===(s=this._listeners[t])||void 0===s?void 0:s.indexOf(e))||void 0===i||!i)}removeEventListener(t,e){var s,i;const n=null!==(i=null===(s=this._listeners[t])||void 0===s?void 0:s.indexOf(e))&&void 0!==i?i:-1;-1!==n&&this._listeners[t].splice(n,1)}dispatchDOMEvent(t,e){e._bubbles=!1,e._stoppedImmediatePropagation=!1,e._defaultPrevented=!1,e._type=t,e._target=this.parent,this._dispatchDOMEvent(t,e)}_dispatchDOMEvent(t,e){if(!this._listeners[t])return;const s=e.currentTarget=this.parent;for(const i of this._listeners[t]){if(e._stoppedImmediatePropagation)break;i.call(s,e)}}dispatchDOMEventAncestor(t,e){let s=this.parent;for(e._bubbles=!0,e._stoppedImmediatePropagation=!1,e._defaultPrevented=!1,e._type=t,e._target=s;s&&e._bubbles;)s.__eventsDispatcher._dispatchDOMEvent(t,e),s=s.parent}dispatchEvent(t,e){if(this._listeners[t])for(const s of this._listeners[t])s.call(this.parent,e)}}let O=1;class j extends h.EventDispatcher{get activableObj(){return this.activable?this:this.parent.activableObj}constructor(t,e,s){super(),this.position=new h.Vector3,this.scale=new h.Vector3(1,1,1),this.quaternion=new h.Quaternion,this.activable=!1,this.active=!1,this.activeUntilParent=!1,this.hovered=!1,this.enabled=!0,this.id=O++,this.parent=t,this.instanceId=e,this.__eventsDispatcher=new E(this),s&&this.setColor(s)}setColor(t){"number"==typeof t?this.parent.setColorAt(this.instanceId,this.parent._tempColor.setHex(t)):this.parent.setColorAt(this.instanceId,t),this.parent.instanceColor.needsUpdate=!0}getColor(t=this.parent._tempColor){return this.parent.getColorAt(this.instanceId,t),t}updateMatrix(){const t=this.parent._tempMatrix;t.compose(this.position,this.quaternion,this.scale),this.parent.setMatrixAt(this.instanceId,t),this.parent.instanceMatrix.needsUpdate=!0}bindEvent(t,e){if("string"==typeof t)return this.__eventsDispatcher.addEventListener(t,e);for(const s of t)this.__eventsDispatcher.addEventListener(s,e);return e}hasBoundEvent(t,e){return this.__eventsDispatcher.hasEventListener(t,e)}unbindEvent(t,e){this.__eventsDispatcher.removeEventListener(t,e)}triggerEvent(t,e){this.__eventsDispatcher.dispatchEvent(t,e)}}const w=(t=>{var e={};return r.d(e,t),e})({Line2:()=>e.Line2}),P=(t=>{var e={};return r.d(e,t),e})({LineGeometry:()=>s.LineGeometry}),S=(t=>{var e={};return r.d(e,t),e})({LineMaterial:()=>i.LineMaterial});class k extends w.Line2{constructor(t=new S.LineMaterial){super(new P.LineGeometry,t),this.bindEvent("rendererresize",(t=>{this.material.resolution.set(t.width,t.height)}))}updateGeoPoints(t,...e){if(!this.createAttributes(t)){const s=this.geometry.attributes.instanceStart.array;for(const i of e){const e=6*(i-1)+3;s[e]=t[i].x,s[e+1]=t[i].y,s[e+2]=t[i].z,s[e+3]=t[i].x,s[e+4]=t[i].y,s[e+5]=t[i].z}this.geometry.attributes.instanceStart.needsUpdate=!0}}setGeoPoints(t){this.createAttributes(t)||(this.fillPositionsArray(t,this.geometry.attributes.instanceStart.array),this.geometry.attributes.instanceStart.needsUpdate=!0)}createAttributes(t){var e;if((null===(e=this.geometry.getAttribute("instanceStart"))||void 0===e?void 0:e.count)!=t.length-1){if(t.length>1){const e=this.fillPositionsArray(t),s=new h.InstancedInterleavedBuffer(e,6,1);this.geometry.setAttribute("instanceStart",new h.InterleavedBufferAttribute(s,3,0)),this.geometry.setAttribute("instanceEnd",new h.InterleavedBufferAttribute(s,3,3)),this.geometry._maxInstanceCount=t.length}return!0}}fillPositionsArray(t,e){var s,i;null!=e||(e=new Float32Array(3*(t.length-1)*2));for(let n=0;n<t.length-1;n++){const r=6*n;e[r]=t[n].x,e[r+1]=t[n].y,e[r+2]=null!==(s=t[n].z)&&void 0!==s?s:0,e[r+3]=t[n+1].x,e[r+4]=t[n+1].y,e[r+5]=null!==(i=t[n+1].z)&&void 0!==i?i:0}return e}}class D extends h.ShaderMaterial{constructor(t,e,s){super(),this.vertexShader="\n        varying vec2 vUv;\n\n\t\tvoid main() {\n            vUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t}",this.fragmentShader="\n        uniform vec3 empty;\n        uniform vec3 fill;\n        uniform float percentage;\n        uniform float time;\n        uniform float height;\n        varying vec2 vUv;\n\n        void main() {\n            if (vUv.y > percentage) {\n                gl_FragColor = vec4(empty + (sin(vUv.y * height + time) * 0.2 - 0.1), 1.0);\n            } else {\n                gl_FragColor = vec4(fill + (cos(vUv.y * height + time) * 0.2 - 0.1), 1.0);\n            }\n        }",this.uniforms={empty:{value:new h.Color(e)},fill:{value:new h.Color(s)},percentage:{value:0},time:{value:0},height:{value:t}}}setPercentage(t){this.uniforms.percentage.value=t}}const A=(t=>{var e={};return r.d(e,t),e})({default:()=>n.default});class L{get bubbles(){return this._bubbles}get defaultPrevented(){return this._defaultPrevented}get target(){return this._target}get type(){return this._type}constructor(t=!1){this.timeStamp=performance.now(),this.cancelable=t}preventDefault(){this._defaultPrevented=!0}stopImmediatePropagation(){this._stoppedImmediatePropagation=!0}stopPropagation(){this._bubbles=!1}}class I extends L{get altKey(){return this._event.altKey}get button(){return this._event.button}get buttons(){return this._event.buttons}get clientX(){return this._event.clientX}get clientY(){return this._event.clientY}get ctrlKey(){return this._event.ctrlKey}get metaKey(){return this._event.metaKey}get movementX(){return this._event.movementX}get movementY(){return this._event.movementY}get offsetX(){return this._event.offsetX}get offsetY(){return this._event.offsetY}get pageX(){return this._event.pageX}get pageY(){return this._event.pageY}get screenX(){return this._event.screenX}get screenY(){return this._event.screenY}get shiftKey(){return this._event.shiftKey}constructor(t,e,s,i,n){super(n),this._event=t,this.intersection=e,this.relatedTarget=i,(null==e?void 0:e.object)===(null==s?void 0:s.object)&&(this.movement=e.point.clone().sub(s.point))}getModifierState(t){return this._event.getModifierState(t)}}class R extends I{get pointerId(){return this._event.pointerId}get width(){return this._event.width}get height(){return this._event.height}get pressure(){return this._event.pressure}get tangentialPressure(){return this._event.tangentialPressure}get tiltX(){return this._event.tiltX}get tiltY(){return this._event.tiltY}get twist(){return this._event.twist}get pointerType(){return this._event.pointerType}get isPrimary(){return this._event.isPrimary}constructor(t,e,s,i,n){super(t,e,s,i,n)}getCoalescedEvents(){}getPredictedEvents(){}}class U extends L{constructor(t,e){super(),this.intersection=t,t.object===(null==e?void 0:e.object)&&(this.movement=t.point.clone().sub(e.point))}}class T extends I{constructor(t,e){super(t,e,void 0)}}class q extends L{constructor(t,e,s){super(),this.renderer=t,this.width=e,this.height=s}}class F extends L{constructor(t){super(),this.relatedTarget=t}}function V(t){t.scenes=[];const e=new h.Clock,s=t.render.bind(t);t.render=function(t,i){this._isGPUPicking?this._isGPUPicking=!1:(u.dispatchEvent(t,"animate",{delta:e.getDelta(),total:e.getElapsedTime()}),u.dispatchEvent(t,"framerendering"),function(){if(p){for(const t of v.data)t.updateMatrix(),t.updateMatrixWorld();v.clear()}}()),s(t,i)};const i=t.setSize.bind(t);t.setSize=function(t,e,s){i(t,e,s);for(const s of this.scenes)u.dispatchEvent(s,"rendererresize",new q(this,t,e))},t.addScene=function(...t){for(const e of t)-1===this.scenes.indexOf(e)&&this.scenes.push(e)},t.removeScene=function(t){const e=this.scenes.indexOf(t);-1!==e&&this.scenes.splice(e,1)}}class X{constructor(){this._items=[]}enqueue(t){if("pointermove"===t.type)for(let e=this._items.length-1;e>=0;e--){const s=this._items[e];if(s.pointerId===t.pointerId){const i=s.type;if("pointermove"===i)return void(this._items[e]=t);if("pointercancel"===i||"pointerdown"===i||"pointerout"===i||"pointerover"===i||"pointerup"===i)break}}this._items.push(t)}dequeue(){const t=this._items;return this._items=[],t}}class G{constructor(t){this.renderer=t,this.enabled=!0,this.raycastGPU=!1,this.pickingTexture=new h.WebGLRenderTarget(1,1),this.intersectionSortComparer=(t,e)=>t.distance===e.distance?e.object.id-t.object.id:t.distance-e.distance,this.continousPointerRaycasting=!0,this.disactiveWhenClickOut=!1,this.pointer=new h.Vector2,this.pointerUv=new h.Vector2,this._raycaster=new h.Raycaster,this._queue=new X,this._mouseDetected=!1,this.registerRenderer(t)}registerRenderer(t){t instanceof h.WebGLRenderer?(t.domElement.addEventListener("contextmenu",(t=>t.preventDefault())),t.domElement.addEventListener("mousemove",(()=>this._mouseDetected=!0)),this.bindEvents()):console.error("Renderer not supported.")}bindEvents(){const t=this.renderer.domElement;t.addEventListener("pointercancel",this.enqueue.bind(this)),t.addEventListener("pointerdown",this.enqueue.bind(this)),t.addEventListener("pointermove",this.enqueue.bind(this)),t.addEventListener("pointerup",this.enqueue.bind(this)),t.addEventListener("wheel",this.enqueue.bind(this)),t.addEventListener("keydown",this.enqueue.bind(this)),t.addEventListener("keyup",this.enqueue.bind(this))}enqueue(t){this._queue.enqueue(t)}update(t,e){if(this.enabled){this._raycasted=!1;for(const s of this._queue.dequeue())this.computeQueuedEvent(s,t,e);this.pointerIntersection(t,e)}}raycastScene(t,e){this._raycasted=!0,this._lastIntersection=this.intersection,this._raycaster.setFromCamera(this.pointerUv,e),this.raycastGPU?this.intersections=this.raycastObjectsGPU(t,e):this.intersections=this.raycastObjects(t,[]),this.intersections.sort(this.intersectionSortComparer),this.intersection=this.intersections[0]}raycastObjects(t,e){if(t.interceptByRaycaster&&t.visible){for(const s of t.children)this.raycastObjects(s,e);let s=e.length;for(t.objectsToRaycast?this._raycaster.intersectObjects(t.objectsToRaycast,!1,e):this._raycaster.intersectObject(t,!1,e);e.length>s;){const i=e[s];i.hitbox=i.object,i.object=t,s++}}return e}raycastObjectsGPU(t,e){const s=this.renderer.domElement.width,i=this.renderer.domElement.height;e.setViewOffset(s,i,this.pointer.x*devicePixelRatio,this.pointer.y*devicePixelRatio,1,1),this.renderer.setRenderTarget(this.pickingTexture),this.renderer.render(t,e),e.clearViewOffset();const n=new Uint8Array(4);this.renderer.readRenderTargetPixels(this.pickingTexture,0,0,1,1,n);const r=n[0]<<16|n[1]<<8|n[2];this.renderer.setRenderTarget(null);const a=z[r],h=[];if(a){a.objectsToRaycast?this._raycaster.intersectObjects(a.objectsToRaycast,!1,h):this._raycaster.intersectObject(a,!1,h);for(const t of h)t.hitbox=t.object,t.object=a}return h}updateCanvasPointerPosition(t){this.pointerUv.x=t.offsetX/this.renderer.domElement.clientWidth*2-1,this.pointerUv.y=t.offsetY/this.renderer.domElement.clientHeight*-2+1,this.pointer.set(t.offsetX,t.offsetY)}triggerAncestorPointer(t,e,s,i,n){if(s){const r=new R(e,this.intersection,this._lastIntersection,i,n);return s.triggerEventAncestor(t,r),r}}triggerAncestorWheel(t,e){if(e){const s=new T(t,this.intersection);e.triggerEventAncestor("wheel",s)}}computeQueuedEvent(t,e,s){switch(t.type){case"pointermove":return this.pointerMove(t,e,s);case"pointerdown":return this.pointerDown(t);case"pointerup":return this.pointerUp(t);case"wheel":return this.wheel(t);default:console.error("Error: computeEvent failed.")}}pointerDown(t){var e;this._lastPointerDown=this.triggerAncestorPointer("pointerdown",t,this.hoveredObj,void 0,!0),(null===(e=this._lastPointerDown)||void 0===e?void 0:e._defaultPrevented)||this.focus(t)}pointerMove(t,e,s){this._lastPointerMove=t,this.updateCanvasPointerPosition(t),this.pointerOutOver(e,s,t),this.triggerAncestorPointer("pointermove",t,this.hoveredObj)}pointerIntersection(t,e){this.continousPointerRaycasting&&(this._mouseDetected&&!this._raycasted&&this.pointerOutOver(t,e,this._lastPointerMove),this.hoveredObj&&this.hoveredObj.triggerEventAncestor("pointerintersection",new U(this.intersection,this._lastIntersection)))}wheel(t){this.triggerAncestorWheel(t,this.hoveredObj)}pointerOutOver(t,e,s){var i;this._lastHoveredObj=this.hoveredObj,this.raycastScene(t,e),this.hoveredObj&&(this.hoveredObj.hovered=!1),this.hoveredObj=null===(i=this.intersection)||void 0===i?void 0:i.object,this.hoveredObj&&(this.hoveredObj.hovered=!0),this._lastHoveredObj!==this.hoveredObj&&(this.triggerAncestorPointer("pointerout",s,this._lastHoveredObj,this.hoveredObj),this.triggerAncestorPointer("pointerleave",s,this._lastHoveredObj,this.hoveredObj),this.triggerAncestorPointer("pointerover",s,this.hoveredObj,this._lastHoveredObj),this.triggerAncestorPointer("pointerenter",s,this.hoveredObj,this._lastHoveredObj))}pointerUp(t){var e,s,i;if(this.triggerAncestorPointer("pointerup",t,this.hoveredObj,null===(e=this._lastPointerDown)||void 0===e?void 0:e._target),this.hoveredObj===(null!==(i=null===(s=this._lastPointerDown)||void 0===s?void 0:s._target)&&void 0!==i?i:null)){const e=this._lastClick;this._lastClick=this.triggerAncestorPointer("click",t,this.hoveredObj),this.hoveredObj===(null==e?void 0:e._target)&&t.timeStamp-e.timeStamp<=300&&(this.triggerAncestorPointer("dblclick",t,this.hoveredObj),this._lastClick=void 0)}else this._lastClick=void 0}focus(t){var e;const s=null===(e=this.hoveredObj)||void 0===e?void 0:e.activableObj;if(t.isPrimary&&this.activeObj!==s){if(!this.disactiveWhenClickOut&&!s)return;const t=new F(s),e=this.activeObj;e&&(e.active=!1,e.triggerEventAncestor("blur",t),e.triggerEvent("focusout",t)),s&&(s.active=!0,t.relatedTarget=e,s.triggerEventAncestor("focus",t),s.triggerEvent("focusin",t)),this.activeObj=s}}}class W extends h.WebGLRenderer{constructor(t,e,s=!0,i={}){if(super(i),this.fullscreen=s,!i.canvas&&document.body.appendChild(this.domElement),V(this),this.addScene(...t),this.activeScene=t[0],this.activeScene)for(const t of this.activeScene.children)if(t.isCamera){this.activeCamera=t;break}window.addEventListener("resize",(()=>this.setSizeByCanvas())),this.setSizeByCanvas(),this.setPixelRatio(window.devicePixelRatio),this.eventsManager=new G(this),this.setAnimationLoop(((t,s)=>{this.eventsManager.update(this.activeScene,this.activeCamera),e(t,s)}))}setSizeByCanvas(){if(this.fullscreen)this.setSize(window.innerWidth,window.innerHeight);else{const{width:t,height:e}=this.domElement.getBoundingClientRect();this.setSize(t,e,!1)}}}class B{constructor(t,e,s=!0,i={}){this.scenes=t,this.animate=e,this.stats=new A.default,this.renderer=new W(t,this.animateBase.bind(this),s,i),document.body.appendChild(this.stats.dom)}animateBase(t,e){this.animate&&this.animate(t,e),this.renderer.render(this.renderer.activeScene,this.renderer.activeCamera),this.stats.update()}}class Y extends h.PerspectiveCamera{constructor(t,e,s){super(t,void 0,e,s),this.bindEvent("rendererresize",(t=>{this.aspect=t.width/t.height,this.updateProjectionMatrix()}))}}var Q=a.x$,H=a.H7,K=a.wO,Z=a.Ex,N=a.Qr,J=a.kX,$=a.SP,tt=a.td,et=a.w_,st=a.Ns,it=a.or,nt=a.gb,rt=a.cP,at=a.DJ,ht=a.Ke,ot=a.RR,ct=a.MZ,lt=a.cQ,_t=a.CP,dt=a.tL,ut=a.Xp,pt=a.cu,vt=a.uF,gt=a.EU,yt=a.Lz,mt=a.zh;export{Q as DistinctTargetArray,H as EventExt,K as EventsCache,Z as EventsDispatcher,N as EventsManager,J as FocusEventExt,$ as InstancedMesh,tt as InstancedMeshSingle,et as Line2,st as LoadingMaterial,it as Main,nt as MouseEventExt,rt as PerspectiveCamera,at as PointerEventExt,ht as PointerEventsQueue,ot as PointerIntersectionEvent,ct as RendererResizeEvent,lt as Utils,_t as WebGLRenderer,dt as WheelEventExt,ut as applyEulerPatch,pt as applyObject3DPatch,vt as applyQuaternionPatch,gt as applyVector3Patch,yt as applyWebGLRendererPatch,mt as object3DList};
import*as t from"three";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},s={};function i(t,e,s){return{timeStamp:t.timeStamp,type:e,target:s,preventDefault:function(){this._preventDefault=!0},stopImmediatePropagation:function(){this._stopImmediatePropagation=this._stopPropagation=!0},stopPropagation:function(){this._stopPropagation=!0},_preventDefault:!1,_stopImmediatePropagation:!1,_stopPropagation:!1}}function n(t,e,s,n){const o=i(t,e,n);return o.altKey=t.altKey,o.button=t.button,o.buttons=t.buttons,o.ctrlKey=t.ctrlKey,o.metaKey=t.metaKey,o.shiftKey=t.shiftKey,o.intersection=s,o.movement=void 0,o.getModifierState=void 0,o}e.d(s,{Ex:()=>o,Qr:()=>c,qO:()=>i,tc:()=>n});class o{constructor(t){this._parent=t,this._listeners={}}addEventListener(t,e){var s;return null!==(s=this._listeners[t])&&void 0!==s||(this._listeners[t]=[]),-1===this._listeners[t].indexOf(e)&&this._listeners[t].push(e),e}hasEventListener(t,e){var s,i;return null!==(i=-1!==(null===(s=this._listeners[t])||void 0===s?void 0:s.indexOf(e)))&&void 0!==i&&i}removeEventListener(t,e){var s,i;const n=null!==(i=null===(s=this._listeners[t])||void 0===s?void 0:s.indexOf(e))&&void 0!==i?i:-1;-1!==n&&this._listeners[t].splice(n,1)}dispatchEvent(t,e){if(this._listeners[t])for(const s of[...this._listeners[t]]){if(e._stopImmediatePropagation)break;s.call(this._parent,e)}}}const r=(a={Object3D:()=>t.Object3D,Raycaster:()=>t.Raycaster,Vector2:()=>t.Vector2},h={},e.d(h,a),h);var a,h;class c{constructor(t){this.intersectionSortComparer=(t,e)=>t.distance-e.distance,this.enabled=!0,this._continousRaycasting=!1,this._canvasPointerPosition=new r.Vector2,this._raycaster=new r.Raycaster,this._domElement=t.domElement,this._domElement.addEventListener("contextmenu",(t=>t.preventDefault())),this.bindEvents()}bindEvents(){const t=this._domElement;t.addEventListener("mousedown",this.mouseDown.bind(this)),t.addEventListener("mousemove",this.mouseMove.bind(this)),t.addEventListener("mouseup",this.mouseUp.bind(this)),t.addEventListener("pointercancel",(t=>{})),t.addEventListener("pointerdown",(t=>{})),t.addEventListener("pointermove",(t=>{})),t.addEventListener("pointerup",(t=>{})),t.addEventListener("touchstart",(t=>{t.preventDefault()})),t.addEventListener("touchcancel",(t=>{})),t.addEventListener("touchend",(t=>{})),t.addEventListener("touchmove",(t=>{})),t.addEventListener("wheel",(t=>{})),t.addEventListener("keydown",(t=>{})),t.addEventListener("keyup",(t=>{}))}updateCanvasPointerPositionMouse(t){this._canvasPointerPosition.x=t.offsetX/this._domElement.clientWidth*2-1,this._canvasPointerPosition.y=t.offsetY/this._domElement.clientHeight*-2+1,this._continousRaycasting=!0}update(t,e,s=!1){this.enabled&&(this._continousRaycasting||s)&&(this._raycaster.setFromCamera(this._canvasPointerPosition,e),this.intersections=this.raycastObjects(t,[]),this.intersections.sort(this.intersectionSortComparer),this.intersection=this.intersections[0])}raycastObjects(t,e){if(t.interceptByRaycaster&&t.visible){for(const s of t.children)this.raycastObjects(s,e);let s=e.length;for(t.objectsToRaycast?this._raycaster.intersectObjects(t.objectsToRaycast,!1,e):this._raycaster.intersectObject(t,!1,e);e.length>s;){const i=e[s];i.hitbox=i.object,i.object=t,s++}}return e}triggerAncestor(t,e,s){for(;t&&(t.triggerEvent(e,s),!s._stopPropagation);)t=t.parent}mouseDown(t){this.triggerAncestor(this.hoveredObj,"mouseDown",n(t,"mouseDown",this.intersection,this.hoveredObj)),this.hoveredObjMouseDown=this.hoveredObj}mouseMove(t){var e;const s=this.hoveredObj;this.updateCanvasPointerPositionMouse(t),this.hoveredObj=null===(e=this.intersection)||void 0===e?void 0:e.object;const i=s!==this.hoveredObj;s&&i&&this.triggerAncestor(s,"mouseOut",n(t,"mouseOut",this.intersection,s)),this.hoveredObj&&i&&this.triggerAncestor(this.hoveredObj,"mouseOver",n(t,"mouseOver",this.intersection,this.hoveredObj)),this.hoveredObj&&this.triggerAncestor(this.hoveredObj,"mouseMove",n(t,"mouseMove",this.intersection,this.hoveredObj))}mouseUp(t){if(this.hoveredObj){if(this.triggerAncestor(this.hoveredObj,"mouseUp",n(t,"mouseUp",this.intersection,this.hoveredObj)),this.hoveredObj!==this.hoveredObjMouseDown)return;this.triggerAncestor(this.hoveredObj,"click",n(t,"click",this.intersection,this.hoveredObj))}this.hoveredObjMouseDown=void 0}}r.Object3D.prototype.interceptByRaycaster=!0,r.Object3D.prototype.bindEvent=function(t,e){var s;return null!==(s=this._eventsDispatcher)&&void 0!==s||(this._eventsDispatcher=new o(this)),this._eventsDispatcher.addEventListener(t.toLowerCase(),e)},r.Object3D.prototype.hasBoundEvent=function(t,e){var s;return null!==(s=this._eventsDispatcher)&&void 0!==s||(this._eventsDispatcher=new o(this)),this._eventsDispatcher.hasEventListener(t.toLowerCase(),e)},r.Object3D.prototype.unbindEvent=function(t,e){var s;null!==(s=this._eventsDispatcher)&&void 0!==s||(this._eventsDispatcher=new o(this)),this._eventsDispatcher.removeEventListener(t.toLowerCase(),e)},r.Object3D.prototype.triggerEvent=function(t,e){var s;null!==(s=this._eventsDispatcher)&&void 0!==s||(this._eventsDispatcher=new o(this)),this._eventsDispatcher.dispatchEvent(t.toLowerCase(),e)};var v=s.Ex,d=s.Qr,u=s.qO,p=s.tc;export{v as EventsDispatcher,d as EventsManager,u as eventExt,p as mouseEventExt};